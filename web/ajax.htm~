<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>Ajax test</title>
<meta name="generator" content="Bluefish 1.0.7">
<meta name="author" content="Michael James Wilber">
<meta name="date" content="2008-12-12T19:30:05-0700">
<meta name="copyright" content="">
<meta name="keywords" content="">
<meta name="description" content="">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8">
<link href="design.css" rel="stylesheet" type="text/css">

<script type="text/javascript" src="jquery-1.2.6.js"></script>
<script type="text/javascript">


$(document).ready(function(){
    
    $.ajaxSetup({
        cache: false,
        async: true
    });
	
    $.getJSON("messages", function (data) {
        $.each(data.items, function(index, text) {
            $("<div class='response'></div>").appendTo(".responseholder").hide().text(text).fadeIn();
        });
    });
    
    function waitformessages() {
    console.log("Waiting for messages...")
        $.getJSON("wait", function(data) {
            $.each(data.items, function(index, text) {
                $("<div class='response'></div>").appendTo(".responseholder").hide().text(text).fadeIn();
            });
            waitformessages();
        });
    }
    waitformessages();
    
    $("form").submit(function(event) {
        console.log("Submitting messages")
        event.preventDefault();
        value = $("#message").val();
        $.get("new", {message: value}, function() {console.log("Message sent")});
        //$("<div class='response'></div>").appendTo(".responseholder").hide().text(value).show("normal");
        $("#message").val("");
         
    });
	
});

</script>
</head>
<body>
<h2>Gutenborg: AJAX + CherryPy Testing Demo</h2>
<form><input id="message" name="message" type="text" /><input type="submit" /></form>
<div class="responseholder"><div class="response">Testing</div></div>
</body>
</html>
